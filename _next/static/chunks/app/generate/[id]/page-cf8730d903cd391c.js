(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[66],{4293:function(e,t,r){Promise.resolve().then(r.bind(r,9830))},9830:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return L}});var n=r(9268),a=r(5334),l=r(6006),s=r(7804),i=r(7346),o=r(1578),c=r(414),d=r(2561),u=r(4475);let h={fog:{intensity:100,on:!0},noiseIterations:8,amplitude:3,frequency:2,waterLevel:3,waterTemplate:!0,waterOpacity:.7,waterColor:"#d4f1f9",width:1e3,height:1e3,sandSolidColor:!0,sandColor:"#C2B280",grassSolidColor:!0,grassColor:"#567d46"},x=(0,d.Ue)()((0,u.tJ)(e=>({...h,updateFog:(t,r)=>e({fog:{intensity:t,on:r}}),updateValue:(t,r)=>e(e=>({...e,[t]:r})),resetTerrain:()=>e(()=>({...h}))}),{name:"config-storage"}));(0,o.e)({Water:c.B});var m=()=>{let e=(0,l.useRef)(null);(0,o.z)(e=>e.gl);let{waterLevel:t,waterTemplate:r,waterColor:a,waterOpacity:i,height:c,width:d}=x(),u=(0,o.D)(s.TextureLoader,"/images/waternormal3.jpeg");u.wrapS=u.wrapT=s.RepeatWrapping;let h=(0,l.useMemo)(()=>new s.PlaneGeometry(d,c),[d,c]),m=(0,l.useMemo)(()=>({textureWidth:512,textureHeight:512,waterNormals:u,sunDirection:new s.Vector3,sunColor:"yellow",waterColor:410227,distortionScale:2,fog:!1}),[u]);return(0,o.A)((t,r)=>{e.current&&(e.current.material.uniforms.time.value+=r/4)}),(0,n.jsx)(n.Fragment,{children:r?(0,n.jsx)("water",{position:[0,t-10,0],ref:e,args:[h,m],"rotation-x":-Math.PI/2,transparent:!0,opacity:.5}):(0,n.jsxs)("mesh",{position:[0,t-10,0],rotation:[-(.5*Math.PI),0,0],children:[(0,n.jsx)("planeGeometry",{args:[d,c]}),(0,n.jsx)("meshStandardMaterial",{color:a,transparent:!0,opacity:i/10})]})})},g=r(8283),p=e=>{let{id:t}=e,r=(0,l.useRef)(null),{progress:a}=(0,g.S)(),{fog:o,noiseIterations:c,amplitude:d,frequency:u,height:h,width:p,sandSolidColor:j,sandColor:f,grassSolidColor:y,grassColor:w}=x(),b=+h,v=+p,C=()=>{if(r.current){let e=[],t=Array(v+1).fill(0).map(()=>Array(b+1).fill(0)),n=(0,i.hA)();for(let e=1;e<c;e++)for(let r=0;r<=v;r++)for(let a=0;a<=b;a++){let l=u/1e3*e,s=n(r*l,a*l)*d,i=s*s*s;t[r][a]=t[r][a]+i}for(let r=0;r<v;r++)for(let n=0;n<b;n++){let a=r,l=n,i=t[r][n],o=t[r][n+1],c=t[r+1][n],d=t[r+1][n+1];e.push(new s.Vector3(a,i,l),new s.Vector3(a,o,l+1),new s.Vector3(a+1,c,l),new s.Vector3(a+1,c,l),new s.Vector3(a,o,l+1),new s.Vector3(a+1,d,l+1))}return r.current.geometry.setFromPoints(e),e}return[]},[N,k]=(0,l.useState)([new s.Vector3]);console.log("xxyyzz",N);let M=e=>{if(r.current){let c=b*v*6,u=()=>{var e=[[.475,.731,.373],[.365,.645,.278],[.298,.543,.224],[.553,.853,.463],[.42,.735,.349]];let t=Math.floor(Math.random()*e.length);return e[t]},h=()=>{var e=[[1,.933,.745],[.918,.847,.62],[.867,.769,.518],[.737,.659,.408],[.627,.553,.333]];let t=Math.floor(Math.random()*e.length);return e[t]};r.current.geometry.setAttribute("color",new s.BufferAttribute(new Float32Array(3*(c||0)),3));for(let x=0;x<(c||0);x++){var t,n,a,l,i,o;let c=e[x];if(c.y>d**3)null===(t=r.current)||void 0===t||t.geometry.attributes.color.setXYZ(x,1,1,1);else if(c.y>2.5)null===(n=r.current)||void 0===n||n.geometry.attributes.color.setXYZ(x,.2,.2,.2);else if(c.y>-2){if(y){let e=u();null===(l=r.current)||void 0===l||l.geometry.attributes.color.setXYZ(x,e[0],e[1],e[2])}else{let e=w.replace("#",""),t=parseInt(e,16),n=new s.Color(t);null===(a=r.current)||void 0===a||a.geometry.attributes.color.setXYZ(x,n.r,n.g,n.b)}}else if(j){let e=h();null===(o=r.current)||void 0===o||o.geometry.attributes.color.setXYZ(x,e[0],e[1],e[2])}else{let e=f.replace("#",""),t=parseInt(e,16),n=new s.Color(t);null===(i=r.current)||void 0===i||i.geometry.attributes.color.setXYZ(x,n.r,n.g,n.b)}}r.current.geometry.attributes.color.needsUpdate=!0,r.current.geometry.computeVertexNormals()}};return(0,l.useEffect)(()=>{if(r.current){let e=C();k(e)}},[]),(0,l.useEffect)(()=>{N.length>10&&M(N)},[N.length,j,f,w,y]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("mesh",{ref:r,position:[-v/2,0,-b/2],castShadow:!0,receiveShadow:!0,children:[(0,n.jsx)("bufferGeometry",{}),(0,n.jsx)("meshStandardMaterial",{vertexColors:!0})]}),o.on?(0,n.jsx)("fog",{attach:"fog",color:"#e8e8e8",near:10,far:800}):null,(0,n.jsx)(m,{})]})},j=r(7011),f=r(304),y=r(1694);let w=e=>{let t="",r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=r.length,a=0;for(;a<e;)t+=r.charAt(Math.floor(Math.random()*n)),a+=1;return t};var b=r(2801),v=r(7743),C=r(7163),N=e=>{let{setMenuOpen:t,menuOpen:r}=e,{updateValue:a,waterLevel:l,waterTemplate:s,waterColor:i,waterOpacity:o}=x();return(0,n.jsxs)("fieldset",{className:"mt-0",children:[(0,n.jsxs)("button",{onClick:()=>t(e=>({...e,water:!e.water})),"aria-label":"open water options",className:"flex justify-between w-full my-4",children:[(0,n.jsx)("h2",{className:"text-lg",children:"Water"}),(0,n.jsx)(b.RiI,{})]}),(0,n.jsx)(v.M,{children:r.water&&(0,n.jsxs)(C.E.div,{animate:{opacity:1,height:"auto",transition:{opacity:{delay:.1}}},initial:{opacity:0,height:0},exit:{height:0,opacity:0,transition:{height:{delay:.1}}},children:[(0,n.jsx)("div",{children:(0,n.jsxs)("label",{children:["Colour",(0,n.jsx)("input",{type:"color",value:i,onChange:e=>a("waterColor",e.target.value)})]})}),(0,n.jsx)("div",{children:(0,n.jsxs)("label",{children:["Realistic Water",(0,n.jsx)("input",{type:"checkbox",id:"water",name:"water",checked:s,onChange:()=>a("waterTemplate",!s)})]})}),(0,n.jsxs)("label",{children:["Water Opacity",(0,n.jsx)("input",{className:"w-full p-1 rounded-sm text-black",type:"range",min:"0",max:"10",value:o,onChange:e=>a("waterOpacity",e.target.value)})]}),(0,n.jsx)("div",{children:(0,n.jsxs)("label",{children:["Water Level",(0,n.jsx)("input",{className:"w-full p-1 rounded-sm text-black",type:"range",min:"0",max:"30",value:l,onChange:e=>a("waterLevel",e.target.value)})]})})]},"waterControls")})]})},k=e=>{let{menuOpen:t,setMenuOpen:r}=e,{fog:a,updateFog:l,noiseIterations:s,updateValue:i,amplitude:o,frequency:c}=x();return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("button",{onClick:()=>r(e=>({...e,environment:!e.environment})),"aria-label":"open environment options",className:"flex justify-between w-full mt-4",children:[(0,n.jsx)("h2",{className:"text-lg",children:"Environment"}),(0,n.jsx)(b.RiI,{})]}),(0,n.jsx)(v.M,{children:t.environment&&(0,n.jsxs)(C.E.div,{animate:{opacity:1,height:"auto",transition:{opacity:{delay:.1}}},initial:{opacity:0,height:0},exit:{height:0,opacity:0,transition:{height:{delay:.1}}},children:[(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,n.jsxs)("label",{children:["Noise Cycles",(0,n.jsx)("input",{className:"w-full p-1 rounded-sm text-black",type:"number",value:s,onChange:e=>i("noiseIterations",e.target.value)})]}),(0,n.jsxs)("label",{className:"flex flex-col items-center  text-center",children:["Fog",(0,n.jsx)("input",{className:"mt-1",type:"checkbox",id:"fog",name:"fog",checked:a.on,onChange:()=>l(a.intensity,!a.on)})]})]}),(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-4 mt-4",children:[(0,n.jsx)("div",{children:(0,n.jsxs)("label",{children:["Amplitude",(0,n.jsx)("input",{className:"w-full p-1 rounded-sm text-black",type:"number",value:o,onChange:e=>i("amplitude",e.target.value)})]})}),(0,n.jsx)("div",{children:(0,n.jsxs)("label",{children:["Frequency",(0,n.jsx)("input",{className:"w-full p-1 rounded-sm text-black",type:"number",value:c,onChange:e=>i("frequency",e.target.value)})]})})]})]},"waterControls")})]})},M=e=>{let{menuOpen:t,setMenuOpen:r}=e,{sandColor:a,sandSolidColor:l,updateValue:s}=x();return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("button",{onClick:()=>r(e=>({...e,sand:!e.sand})),"aria-label":"open environment options",className:"flex justify-between w-full mt-4",children:[(0,n.jsx)("h2",{className:"text-lg",children:"Sand"}),(0,n.jsx)(b.RiI,{})]}),(0,n.jsx)(v.M,{children:t.sand&&(0,n.jsx)(C.E.div,{animate:{opacity:1,height:"auto",transition:{opacity:{delay:.1}}},initial:{opacity:0,height:0},exit:{height:0,opacity:0,transition:{height:{delay:.1}}},children:(0,n.jsx)("div",{className:"grid grid-cols-2 gap-4",children:(0,n.jsxs)("div",{children:[(0,n.jsxs)("label",{children:["Solid Colour",(0,n.jsx)("input",{type:"checkbox",checked:l,onChange:e=>s("sandSolidColor",!l)})]}),(0,n.jsxs)("label",{children:["Sand Colour Colour",(0,n.jsx)("input",{type:"color",value:a,onChange:e=>s("sandColor",e.target.value)})]})]})})},"waterControls")})]})},S=e=>{let{menuOpen:t,setMenuOpen:r}=e,{grassColor:a,grassSolidColor:l,updateValue:s}=x();return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("button",{onClick:()=>r(e=>({...e,grass:!e.grass})),"aria-label":"open environment options",className:"flex justify-between w-full mt-4",children:[(0,n.jsx)("h2",{className:"text-lg",children:"Grass"}),(0,n.jsx)(b.RiI,{})]}),(0,n.jsx)(v.M,{children:t.grass&&(0,n.jsx)(C.E.div,{animate:{opacity:1,height:"auto",transition:{opacity:{delay:.1}}},initial:{opacity:0,height:0},exit:{height:0,opacity:0,transition:{height:{delay:.1}}},children:(0,n.jsx)("div",{className:"grid grid-cols-2 gap-4",children:(0,n.jsxs)("div",{children:[(0,n.jsxs)("label",{children:["Solid Colour",(0,n.jsx)("input",{type:"checkbox",checked:l,onChange:e=>s("grassSolidColor",!l)})]}),(0,n.jsxs)("label",{children:["Grass Colour Colour",(0,n.jsx)("input",{type:"color",value:a,onChange:e=>s("grassColor",e.target.value)})]})]})})},"grassControls")})]})},O=e=>{let t=w(8),{updateValue:r,height:a,width:s,resetTerrain:i}=x(),[o,c]=(0,l.useState)({water:!0,environment:!0,sand:!0,grass:!0});return(0,n.jsxs)("div",{className:"z-10 absolute top-5 right-5 bg-slate-800 text-white p-3 rounded-md shadow-lg w-60",children:[(0,n.jsx)("h1",{className:"text-white text-xl",children:"Terrain Customisations"}),(0,n.jsx)("hr",{}),(0,n.jsx)(N,{menuOpen:o,setMenuOpen:c}),(0,n.jsx)("hr",{}),(0,n.jsx)(k,{menuOpen:o,setMenuOpen:c}),(0,n.jsx)("hr",{className:"mt-4"}),(0,n.jsx)(M,{menuOpen:o,setMenuOpen:c}),(0,n.jsx)("hr",{className:"mt-4"}),(0,n.jsx)(S,{menuOpen:o,setMenuOpen:c}),(0,n.jsxs)("div",{className:"mt-2",children:[(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,n.jsxs)("label",{children:["Width",(0,n.jsx)("input",{type:"number",onChange:e=>r("width",e.target.value),className:"w-full p-1 rounded-sm text-black",value:s})]}),(0,n.jsxs)("label",{children:["Height",(0,n.jsx)("input",{className:"w-full p-1 rounded-sm text-black",type:"number",onChange:e=>r("height",e.target.value),value:a})]})]}),(0,n.jsx)("a",{className:"flex justify-center p-2 items-center mt-4 bg-white rounded-md",href:"/generate/".concat(t),children:(0,n.jsx)("span",{className:"text-slate-800",children:"Generate New"})}),(0,n.jsxs)("div",{className:"grid grid-cols-2 col-4 mt-4",children:[(0,n.jsx)("button",{className:" underline",children:"Download"}),(0,n.jsx)("button",{className:" underline",onClick:()=>i(),children:"Reset"})]})]})]})},L=e=>{let{params:t}=e;return(0,n.jsxs)("main",{className:"flex min-h-screen flex-col items-center justify-center h-screen bg-black",children:[(0,n.jsx)(O,{}),(0,n.jsx)(l.Suspense,{fallback:(0,n.jsx)("h1",{children:"Loading... Loading... Loading... Loading... Loading..."}),children:(0,n.jsxs)(a.Xz,{shadows:!0,children:[(0,n.jsx)(j.z,{}),(0,n.jsx)(f.c,{position:[200,5,100],makeDefault:!0}),(0,n.jsx)("ambientLight",{intensity:.2}),(0,n.jsx)(y.q,{}),(0,n.jsx)("spotLight",{position:[-250,50,50],castShadow:!0}),(0,n.jsx)(p,{id:t.id})]})})]})}}},function(e){e.O(0,[230,296,863,530,253,488,744],function(){return e(e.s=4293)}),_N_E=e.O()}]);